<ControlTheme TargetType="atom:DataGridColumnHeader"
              xmlns="https://github.com/avaloniaui"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:converters="using:AtomUI.Desktop.Controls.Converters"
              x:Class="AtomUI.Desktop.Controls.Themes.DataGridColumnHeaderTheme"
              x:ClassModifier="internal"
              xmlns:atom="https://atomui.net">
    <Setter Property="Template">
        <ControlTemplate TargetType="atom:DataGridColumnHeader">
            <Border Name="Frame" Background="{TemplateBinding Background}">
                <Panel Name="RootLayout">
                    <Border Name="ContentFrame">
                        <DockPanel LastChildFill="True" Name="ContentLayout">
                            <StackPanel Name="IndicatorsLayout"
                                        Orientation="Horizontal"
                                        DockPanel.Dock="Right"
                                        IsVisible="{TemplateBinding IndicatorLayoutVisible}">
                                <atom:DataGridSortIndicator
                                    Name="{x:Static atom:DataGridColumnHeaderThemeConstants.SortIndicatorPart}"
                                    VerticalAlignment="Center"
                                    IsVisible="{TemplateBinding CanUserSort}"
                                    SupportedSortDirections="{TemplateBinding SupportedSortDirections}" />
                                <atom:DataGridFilterIndicator
                                    IsEnableHoverEffect="True"
                                    Name="{x:Static atom:DataGridColumnHeaderThemeConstants.FilterIndicatorPart}"
                                    VerticalAlignment="Center">
                                    <atom:DataGridFilterIndicator.IsVisible>
                                        <MultiBinding
                                            Converter="{x:Static converters:DataGridFilterIndicatorVisibleConvert.Default}">
                                            <Binding Path="IsSeparatorsVisible"
                                                     RelativeSource="{RelativeSource TemplatedParent}" />
                                            <Binding Path="CanUserFilter"
                                                     RelativeSource="{RelativeSource TemplatedParent}" />
                                            <Binding Path="OwningColumn?.Filters.Count"
                                                     RelativeSource="{RelativeSource TemplatedParent}" />
                                        </MultiBinding>
                                    </atom:DataGridFilterIndicator.IsVisible>
                                </atom:DataGridFilterIndicator>
                            </StackPanel>
                            <ContentPresenter
                                Name="ContentPresenter"
                                HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}"
                                ContentTemplate="{TemplateBinding ContentTemplate}" />
                        </DockPanel>
                    </Border>
                    <Rectangle Name="VerticalSeparator"
                               Width="1.0"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right"
                               IsVisible="{TemplateBinding IsSeparatorsVisible}" />
                    <Panel Name="FocusVisual"
                           IsVisible="False"
                           IsHitTestVisible="False">
                        <Rectangle Name="FocusVisualPrimary"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   Fill="Transparent"
                                   IsHitTestVisible="False"
                                   StrokeThickness="2" />
                        <Rectangle Name="FocusVisualSecondary"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   Fill="Transparent"
                                   IsHitTestVisible="False"
                                   StrokeThickness="1" />
                    </Panel>
                </Panel>
            </Border>
        </ControlTemplate>
    </Setter>

    <Style Selector="^:is(atom|DataGridColumnHeader)">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TableHeaderTextColor}}" />
        <Setter Property="FontWeight" Value="{DynamicResource {x:Static atom:SharedTokenKey.FontWeightStrong}}" />
        <Setter Property="atom:ToolTip.Placement" Value="Top" />
        <Setter Property="atom:ToolTip.ShowDelay" Value="1000" />
        <Setter Property="atom:ToolTip.ServiceEnabled" Value="False" />
        <Setter Property="atom:ToolTip.IsCustomShowAndHide" Value="True" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="ClipToBounds" Value="False" />
        <Setter Property="Background" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TableHeaderBg}}" />
        <Style Selector="^[ShowSorterTooltip=True]">
            <Setter Property="atom:ToolTip.ServiceEnabled" Value="True" />
        </Style>

        <Style Selector="^[SizeType=Large]">
            <Style Selector="^ /template/ Border#ContentFrame">
                <Setter Property="Padding" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TablePadding}}" />
            </Style>
            <Setter Property="FontSize" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TableFontSize}}" />
        </Style>
        <Style Selector="^[SizeType=Middle]">
            <Style Selector="^ /template/ Border#ContentFrame">
                <Setter Property="Padding"
                        Value="{DynamicResource {x:Static atom:DataGridTokenKey.TablePaddingMiddle}}" />
            </Style>
            <Setter Property="FontSize" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TableFontSizeMiddle}}" />
        </Style>
        <Style Selector="^[SizeType=Small]">
            <Style Selector="^ /template/ Border#ContentFrame">
                <Setter Property="Padding" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TablePaddingSmall}}" />
            </Style>
            <Setter Property="FontSize" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TableFontSizeSmall}}" />
        </Style>

        <Style Selector="^ /template/ Rectangle#VerticalSeparator">
            <Setter Property="Fill" Value="{DynamicResource {x:Static atom:DataGridTokenKey.HeaderSplitColor}}" />
            <Setter Property="Height" Value="{DynamicResource {x:Static atom:SharedTokenKey.FontHeight}}" />
        </Style>

        <Style Selector="^ /template/ StackPanel#IndicatorsLayout">
            <Setter Property="Spacing" Value="{DynamicResource {x:Static atom:SharedTokenKey.UniformlyMarginXXS}}" />
        </Style>
        
        <Style Selector="^ /template/ DockPanel#ContentLayout">
            <Setter Property="HorizontalSpacing" Value="{DynamicResource {x:Static atom:SharedTokenKey.UniformlyMarginXS}}" />
        </Style>
        <Style Selector="^:sort-ascending">
            <Style Selector="^ /template/ atom|DataGridSortIndicator#PART_SortIndicator">
                <Setter Property="CurrentSortDirection" Value="Ascending" />
            </Style>
        </Style>
        <Style Selector="^:sort-descending">
            <Style Selector="^ /template/ atom|DataGridSortIndicator#PART_SortIndicator">
                <Setter Property="CurrentSortDirection" Value="Descending" />
            </Style>
        </Style>
        <Style Selector="^:pointerover">
            <Style Selector="^ /template/ atom|DataGridSortIndicator#PART_SortIndicator">
                <Setter Property="IsHoverMode" Value="True" />
            </Style>
        </Style>

        <Style Selector="^[CanUserSort=True]">
            <Style Selector="^:sort-ascending, ^:sort-descending">
                <Setter Property="Background"
                        Value="{DynamicResource {x:Static atom:DataGridTokenKey.HeaderSortActiveBg}}" />
            </Style>

            <Style Selector="^ /template/ Border#Frame">
                <Setter Property="Cursor" Value="Hand" />
            </Style>
        
            <Style Selector="^:pointerover">
                <Setter Property="Background"
                        Value="{DynamicResource {x:Static atom:DataGridTokenKey.HeaderSortHoverBg}}" />
            </Style>
        </Style>

        <Style Selector="^:drag-indicator">
            <Setter Property="Background" Value="#808080" />
        </Style>

        <Style Selector="^[HeaderDragMode=Reorder]">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static atom:DataGridTokenKey.ColumnReorderActiveBg}}" />
        </Style>

        <Style Selector="^[IsShowFrozenShadow=True]">

            <Setter Property="Background" Value="{DynamicResource {x:Static atom:DataGridTokenKey.TableHeaderBg}}" />

            <Style Selector="^[FrozenShadowPosition=Left]">
                <Style Selector="^ /template/ Border#Frame">
                    <Setter Property="BoxShadow"
                            Value="{DynamicResource {x:Static atom:DataGridTokenKey.LeftFrozenShadows}}" />
                </Style>
            </Style>

            <Style Selector="^[FrozenShadowPosition=Right]">
                <Style Selector="^ /template/ Border#Frame">
                    <Setter Property="BoxShadow"
                            Value="{DynamicResource {x:Static atom:DataGridTokenKey.RightFrozenShadows}}" />
                </Style>
            </Style>
        </Style>
    </Style>
</ControlTheme>