<ControlTheme xmlns="https://github.com/avaloniaui"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:atom="https://atomui.net"
              x:Class="AtomUI.Controls.Themes.SimpleTextBoxTheme"
              x:ClassModifier="internal"
              TargetType="atom:SimpleTextBox">
    <Setter Property="Template">
        <ControlTemplate TargetType="atom:SimpleTextBox">
            <Border
                Name="InnerBoxDecorator"
                Padding="{TemplateBinding Padding}"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="{TemplateBinding CornerRadius}"
                BorderBrush="{TemplateBinding BorderBrush}"
                Background="{TemplateBinding Background}">
                <DockPanel Name="ContentLayout" LastChildFill="True">
                    <StackPanel
                        Name="{x:Static atom:AddOnDecoratedInnerBoxThemeConstants.LeftAddOnLayoutPart}"
                        Orientation="Horizontal"
                        DockPanel.Dock="Left">
                        <ContentPresenter
                            Name="{x:Static atom:AddOnDecoratedInnerBoxThemeConstants.LeftAddOnPart}"
                            VerticalAlignment="Stretch"
                            VerticalContentAlignment="Center"
                            HorizontalAlignment="Left"
                            Focusable="False"
                            Content="{TemplateBinding ContentLeftAddOn}"
                            ContentTemplate="{TemplateBinding ContentLeftAddOnTemplate}" />
                    </StackPanel>
            
                    <StackPanel
                        Name="{x:Static atom:AddOnDecoratedInnerBoxThemeConstants.RightAddOnLayoutPart}"
                        Orientation="Horizontal"
                        DockPanel.Dock="Right">
                        <atom:IconButton
                            Name="{x:Static atom:AddOnDecoratedInnerBoxThemeConstants.ClearButtonPart}"
                            Icon="{atom:IconProvider CloseCircleFilled}"
                            IsVisible="{TemplateBinding IsEffectiveShowClearButton}" />
                        <!-- 新增显示密码按钮 -->
                        <atom:ToggleIconButton
                            Name="{x:Static atom:TextBoxInnerBoxThemeConstants.RevealButtonPart}"
                            CheckedIcon="{atom:IconProvider EyeOutlined}"
                            UnCheckedIcon="{atom:IconProvider EyeInvisibleOutlined}"
                            IsChecked="{TemplateBinding RevealPassword, Mode=TwoWay}"
                            IsVisible="{TemplateBinding IsEnableRevealButton}" />
                        <ContentPresenter
                            Name="{x:Static atom:AddOnDecoratedInnerBoxThemeConstants.RightAddOnPart}"
                            VerticalAlignment="Stretch"
                            VerticalContentAlignment="Center"
                            HorizontalAlignment="Right"
                            Focusable="False"
                            Content="{TemplateBinding ContentRightAddOn}"
                            ContentTemplate="{TemplateBinding ContentRightAddOnTemplate}" />
                    </StackPanel>
            
                    <ScrollViewer
                        Name="ScrollViewer"
                        Cursor="Ibeam"
                        AllowAutoHide="{TemplateBinding ScrollViewer.AllowAutoHide}"
                        HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                        VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
                        IsScrollChainingEnabled="{TemplateBinding ScrollViewer.IsScrollChainingEnabled}">
                        <Panel>
                            <atom:TextBlock
                                Name="Watermark"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Text="{TemplateBinding Watermark}"
                                LineHeight="{TemplateBinding LineHeight}"
                                TextAlignment="{TemplateBinding TextAlignment}"
                                TextWrapping="{TemplateBinding TextWrapping}"
                                IsVisible="{TemplateBinding Text, Converter={x:Static StringConverters.IsNullOrEmpty}}" />
                            <TextPresenter
                                Name="PART_TextPresenter"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                CaretBlinkInterval="{TemplateBinding CaretBlinkInterval}"
                                CaretBrush="{TemplateBinding CaretBrush}"
                                CaretIndex="{TemplateBinding CaretIndex}"
                                LineHeight="{TemplateBinding LineHeight}"
                                PasswordChar="{TemplateBinding PasswordChar}"
                                RevealPassword="{TemplateBinding RevealPassword}"
                                SelectionBrush="{TemplateBinding SelectionBrush}"
                                SelectionStart="{TemplateBinding SelectionStart}"
                                SelectionEnd="{TemplateBinding SelectionEnd}"
                                SelectionForegroundBrush="{TemplateBinding SelectionForegroundBrush}"
                                Text="{TemplateBinding Text, Mode=TwoWay}"
                                TextAlignment="{TemplateBinding TextAlignment}"
                                TextWrapping="{TemplateBinding TextWrapping}" />
                        </Panel>
                    </ScrollViewer>
                </DockPanel>
            </Border>
        </ControlTemplate>
    </Setter>

    <Style Selector="^:is(atom|SimpleTextBox)">
        <Setter Property="SelectionBrush" Value="{DynamicResource {x:Static atom:SharedTokenKey.SelectionBackground}}" />
        <Setter Property="CaretBrush" Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorText}}" />
        <Setter Property="SelectionForegroundBrush"
                Value="{DynamicResource {x:Static atom:SharedTokenKey.SelectionForeground}}" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="ScrollViewer.IsScrollChainingEnabled" Value="True" />
    
        <Style Selector="^ /template/ atom|ToggleIconButton#PART_RevealButton">
            <Setter Property="IconWidth" Value="{DynamicResource {x:Static atom:SharedTokenKey.IconSize}}" />
            <Setter Property="IconHeight" Value="{DynamicResource {x:Static atom:SharedTokenKey.IconSize}}" />
            <Setter Property="NormalIconBrush"
                    Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorTextTertiary}}" />
            <Setter Property="ActiveIconBrush" Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorText}}" />
            <Setter Property="SelectedIconBrush" Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorText}}" />
        </Style>
    
        <Style Selector="^[SizeType=Large]">
            <Setter Property="LineHeight" Value="{DynamicResource {x:Static atom:SharedTokenKey.FontHeightLG}}" />
        </Style>
        <Style Selector="^[SizeType=Middle]">
            <Setter Property="LineHeight" Value="{DynamicResource {x:Static atom:SharedTokenKey.FontHeight}}" />
        </Style>
        <Style Selector="^[SizeType=Small]">
            <Setter Property="LineHeight" Value="{DynamicResource {x:Static atom:SharedTokenKey.FontHeightSM}}" />
            <Style Selector="^ /template/ TextPresenter#PART_TextPresenter">
                <Setter Property="Margin" Value="0, 1, 0, 1" />
            </Style>
        </Style>
    
        <Style Selector="^[IsCustomFontSize=False]">
            <Style Selector="^[SizeType=Large]">
                <Setter Property="FontSize" Value="{DynamicResource {x:Static atom:LineEditTokenKey.InputFontSizeLG}}" />
            </Style>
            <Style Selector="^[SizeType=Middle]">
                <Setter Property="FontSize" Value="{DynamicResource {x:Static atom:LineEditTokenKey.InputFontSize}}" />
            </Style>
            <Style Selector="^[SizeType=Small]">
                <Setter Property="FontSize" Value="{DynamicResource {x:Static atom:LineEditTokenKey.InputFontSizeSM}}" />
            </Style>
        </Style>
    
        <Style Selector="^ /template/ atom|TextBlock#Watermark">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorTextPlaceholder}}" />
        </Style>
    
        <Style Selector="^ /template/ TextPresenter#PART_TextPresenter">
            <Setter Property="Margin"
                    Value="2 0 2 0" />
        </Style>
    
        <Style Selector="^ /template/ StackPanel#PART_LeftAddOnLayout, ^ /template/ StackPanel#PART_RightAddOnLayout">
            <Setter Property="Spacing"
                    Value="{DynamicResource {x:Static atom:SharedTokenKey.UniformlyPaddingXXS}}" />
        </Style>
    
        <Style Selector="^ /template/ atom|IconButton#PART_ClearButton">
            <Setter Property="IconWidth" Value="{DynamicResource {x:Static atom:SharedTokenKey.IconSize}}" />
            <Setter Property="IconHeight" Value="{DynamicResource {x:Static atom:SharedTokenKey.IconSize}}" />
            <Setter Property="NormalIconBrush"
                    Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorTextQuaternary}}" />
            <Setter Property="ActiveIconBrush"
                    Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorTextTertiary}}" />
            <Setter Property="SelectedIconBrush" Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorText}}" />
        </Style>
    
        <Style Selector="^[IsEnabled=False]">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorBgContainerDisabled}}" />
        </Style>
        <Style Selector="^:disabled">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static atom:SharedTokenKey.ColorTextDisabled}}" />
        </Style>
    </Style>
</ControlTheme>